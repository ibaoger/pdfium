{
  "comments": [
    {
      "key": {
        "uuid": "5e31ad57_35b70fcb",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-25T17:52:39Z",
      "side": 1,
      "message": "This seems like it should be a method on CPDF_Dictionary since all paths ask the dictionary questions.",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e5aa00ba_2011df5c",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-25T18:38:27Z",
      "side": 1,
      "message": "No.\nThis is en[de]cryption specific logic, and i think that, dictionary should not know about this. It is should be stayed as universal object. And this is just the particular application of it.",
      "parentUuid": "5e31ad57_35b70fcb",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "99a1c53a_be509b02",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-26T14:15:39Z",
      "side": 1,
      "message": "So, to me this is the same issue as the decryption logic location and the ObjectWriter CL. Logic related to the object should live with the object. If it\u0027s a signature dictionary is something the dictionary can tell us. How to serialize a String is something string can tell us.\n\nSpreading that logic around into all kinds of ObjectWriter and CryptoHandler it makes those helper objects a lot larger then they need to be (we\u0027ve already split up a few of these where it was very had to tell what was happening). It also makes them a lot harder to have comprehensive tests as you now need to be testing into other classes.",
      "parentUuid": "e5aa00ba_2011df5c",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "55bd543a_4260cb16",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-26T14:59:27Z",
      "side": 1,
      "message": "The CPDF_Dictionary is just abstract container, which can contains different data. And only component which should use concreate dictionary should know about it real structure. For example the dictionary can be:\nPage, PagesTree, Signature, Object Stream Info, BitmapInfo, raw stream info, video stream info, FontInfo, Trailer, Annotation, Form, XFA Form,  .... etc.\nAnd for all of this types we have special components which can correctly check and process dictionary data with its specific.\n\nI think, that will be stupid if BitmapInfo will be contained method IsSignDictionary, because this is not related to bitmap.\n\nAs result the decryption logic is related only to decryption component, not to abstract dictionary object.\nLike bitmap info can not be related to CPDF_Dictionary, it is related to bitmap de[en]coder.\n\nBut by your suggestion we should move all logic, wich can use dictionary, into dictionary implementation (Bitmaps, annotations, pages ... ).\n\nThe decryption is not method of object, this is method above object. Just one application of much other.\n\n\u003e\u003e It also makes them a lot harder to have comprehensive tests as you now need to be testing into other classes.\nHm... In this CL only one component, and it is can be simple tested in one unittest file. (I have not created it yet, because still waiting Cl with CPDF_Writer)\nOpposite in your case, we should create test with similar code for each object type in different files. As result will be realy hard to understand, how de[en]cryption working, beacuse each small part of de[en]cryption will be spreaded onto many files.",
      "parentUuid": "99a1c53a_be509b02",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6f8bd4f8_1d2cef6c",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 335,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-25T17:52:39Z",
      "side": 1,
      "message": "This would be better named DecryptObjectAndChildren or something as it walks all of the sub-objects",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2928028f_a2e33810",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 335,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-25T18:38:27Z",
      "side": 1,
      "message": "What about \"DecryptIndirectObject\"? \nLike in other places?",
      "parentUuid": "6f8bd4f8_1d2cef6c",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0d520720_387ce65b",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 335,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-26T14:15:39Z",
      "side": 1,
      "message": "But this doesn\u0027t just decrypt the indirect object, it also decrypts all of the children as well.",
      "parentUuid": "2928028f_a2e33810",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a5e351e6_ce49e8ec",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 335,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-26T14:59:27Z",
      "side": 1,
      "message": "alternative\nDecryptObjectsTree ?",
      "parentUuid": "0d520720_387ce65b",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8e2d05d5_f9af33b9",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 340,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-25T17:52:39Z",
      "side": 1,
      "message": "make this a stack of structs so we can name the dict and object for clarity.",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "acd568e5_e0b6acca",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 340,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-25T18:58:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8e2d05d5_f9af33b9",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a9b30e7f_07684af0",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 352,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-25T17:52:39Z",
      "side": 1,
      "message": "Store walker.GetParent()-\u003eGetDict() in a temporary",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d70f29b1_0f2aa952",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 352,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-25T18:58:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a9b30e7f_07684af0",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d89a9055_529afbe4",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 364,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-25T17:52:39Z",
      "side": 1,
      "message": "These blocks seem like they should be methods on the objects themselves. Then you\u0027d just do child-\u003eDecrypt() instead of having the multiple if\u0027s.",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3609515d_d3fb8ac0",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 364,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-25T18:38:27Z",
      "side": 1,
      "message": "Why we should spread the decryption logic in much places?\nIt is will make reading worse and increase complexity.\nIn This CL it is solid. \nAlso:\n1) Only two types of object have decryption - strings and streams, why we need that for other?\n2) Decryption is used only in one place of (CPDF_SyntaxParser::ParseIndirectObjectInternal). In other places it is should be never used. (For other places it is invisible.)",
      "parentUuid": "d89a9055_529afbe4",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f795e091_e50ddd6c",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 374,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-25T17:52:39Z",
      "side": 1,
      "message": "In the original code we wouldn\u0027t even have a CPDF_Stream we\u0027d have returned nullptr earlier. We will now have a stream with a nullptr as it\u0027s data. Is that going to cause any issues in the code which uses the streams?",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e8fc5f3c_076070cb",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 374,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-25T18:38:27Z",
      "side": 1,
      "message": "See https://pdfium.googlesource.com/pdfium.git/+/957480c17682008ae2a14723868fcdcab89b6577",
      "parentUuid": "f795e091_e50ddd6c",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f9f0396a_346d1054",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 391,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-25T17:52:39Z",
      "side": 1,
      "message": "What does this mean, decryption failed?",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e6422fa0_a7fba163",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 391,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-25T18:38:27Z",
      "side": 1,
      "message": "Yes",
      "parentUuid": "f9f0396a_346d1054",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e2fd398_f2a5954e",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 399,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-25T17:52:39Z",
      "side": 1,
      "message": "What about if it is a signature dictionary? We just ignore it? Leave it encrypted? what happens?",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2a650b5b_b36894c7",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 399,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-25T18:38:27Z",
      "side": 1,
      "message": "The contents of signature dictionary already decrypted, and should stay unchanged. Just skipping decryptrion of it.",
      "parentUuid": "4e2fd398_f2a5954e",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e8b3fc60_fbd4c831",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 399,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-26T14:15:39Z",
      "side": 1,
      "message": "But doesn\u0027t the comment above on 353 says the signature dictionary wasn\u0027t decrypted, so doesn\u0027t this mean it won\u0027t be decrypted?",
      "parentUuid": "2a650b5b_b36894c7",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7766a84e_c8c9e48b",
        "filename": "core/fpdfapi/parser/cpdf_crypto_handler.cpp",
        "patchSetId": 5
      },
      "lineNbr": 399,
      "author": {
        "id": 7160
      },
      "writtenOn": "2017-09-26T14:59:27Z",
      "side": 1,
      "message": "By PDF specification (and original implementation) its should stay unchanged. As result i suggest that it is already decrypted.",
      "parentUuid": "e8b3fc60_fbd4c831",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9bb283cf_39a5a525",
        "filename": "core/fpdfapi/parser/cpdf_syntax_parser.cpp",
        "patchSetId": 5
      },
      "lineNbr": 555,
      "author": {
        "id": 5965
      },
      "writtenOn": "2017-09-25T17:52:39Z",
      "side": 1,
      "message": "Indenting is wrong here.",
      "revId": "7b96a08e25afc420eec6f30c547f4079e29d0d71",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    }
  ]
}