{
  "comments": [
    {
      "key": {
        "uuid": "08f31b7b_fa04562a",
        "filename": "core/fxge/dib/cfx_dibsource.cpp",
        "patchSetId": 3
      },
      "lineNbr": 274,
      "author": {
        "id": 5045
      },
      "writtenOn": "2017-08-02T01:26:25Z",
      "side": 1,
      "message": "Can the fixes in here go in its own CL? Is it possible to show the existing code is wrong without the rest of this CL?",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "50645b69_4dbe269c",
        "filename": "core/fxge/dib/cfx_dibsource.cpp",
        "patchSetId": 3
      },
      "lineNbr": 274,
      "author": {
        "id": 6975
      },
      "writtenOn": "2017-08-02T01:41:48Z",
      "side": 1,
      "message": "Sure it can, but for testing, I\u0027m not sure how we would do that since we need an API for getting the bitmap to test this. Should I put it in another CL and submit it after this one?",
      "parentUuid": "08f31b7b_fa04562a",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0bf40330_366587f0",
        "filename": "core/fxge/dib/cfx_dibsource.cpp",
        "patchSetId": 3
      },
      "lineNbr": 274,
      "author": {
        "id": 5045
      },
      "writtenOn": "2017-08-02T21:28:47Z",
      "side": 1,
      "message": "Write a unit test for some internal caller of this function?",
      "parentUuid": "50645b69_4dbe269c",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "13b80c68_a107154e",
        "filename": "core/fxge/dib/cfx_dibsource.cpp",
        "patchSetId": 3
      },
      "lineNbr": 274,
      "author": {
        "id": 6975
      },
      "writtenOn": "2017-08-03T01:13:20Z",
      "side": 1,
      "message": "So I tried to write a unit test that calls ConvertBuffer() but it\u0027s taking me so long that I\u0027m not sure if it\u0027s worth it... To use ConvertBuffer() without getting a bitmap, we need to make a bitmap object that has an appropriate source stream, which needs to have the appropriate palette, bpc, components, etc. for the conversion to work.\nDo you see any other slightly easier way out of this?",
      "parentUuid": "0bf40330_366587f0",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fcdf3cb4_96b39ad7",
        "filename": "core/fxge/dib/cfx_dibsource.cpp",
        "patchSetId": 3
      },
      "lineNbr": 274,
      "author": {
        "id": 5045
      },
      "writtenOn": "2017-08-03T01:40:36Z",
      "side": 1,
      "message": "I\u0027m just glancing at this, but maybe make a CPDF_Stream and load some hand crafted data into it?\n\nTaking a step back, without this change, what goes wrong?",
      "parentUuid": "13b80c68_a107154e",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6e35fa76_ad97a228",
        "filename": "core/fxge/dib/cfx_dibsource.cpp",
        "patchSetId": 3
      },
      "lineNbr": 274,
      "author": {
        "id": 6975
      },
      "writtenOn": "2017-08-03T02:12:53Z",
      "side": 1,
      "message": "Yea, the stream is not the problem, it\u0027s setting the CFX_DIBSource object to have the right parameters for buffer converting that takes more work. One thing I tried was to make a test child class inheriting CPDF_DIBSource so we can directly access CFX_DIBSource\u0027s protected parameters, but CPDF_DIBSource\u0027s constructor is private, and I\u0027m not sure what\u0027s the best way to deal with that...\nWithout this change, when converting from 1bpp to 8bpp, all the pixels will basically be black since they will all be set to be 0 or 1. To test this, we can verify the converted bitmap if we have the GetBitmap() API; for visual results, --save-images would demonstrate it. \nIf we want to separate this part out, I feel like the easiest way would be to leave it in a followup CL. The bitmap embedder test on 1bpp images could verify that this function behaves correctly.",
      "parentUuid": "fcdf3cb4_96b39ad7",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eab12b6c_a3319637",
        "filename": "public/fpdf_edit.h",
        "patchSetId": 3
      },
      "lineNbr": 291,
      "author": {
        "id": 5045
      },
      "writtenOn": "2017-08-02T01:26:25Z",
      "side": 1,
      "message": "Get a bitmap rendering of |image_object|. There\u0027s no |bitmap| variable.",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8946f27c_d483574d",
        "filename": "public/fpdf_edit.h",
        "patchSetId": 3
      },
      "lineNbr": 291,
      "author": {
        "id": 6975
      },
      "writtenOn": "2017-08-02T01:41:48Z",
      "side": 1,
      "message": "I\u0027m not sure if we should say rendering here, since we are not really rendering it, just getting the image stream data and put it in a bitmap.",
      "parentUuid": "eab12b6c_a3319637",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3bf2163e_9306096f",
        "filename": "public/fpdf_edit.h",
        "patchSetId": 3
      },
      "lineNbr": 291,
      "author": {
        "id": 5045
      },
      "writtenOn": "2017-08-02T21:28:47Z",
      "side": 1,
      "message": "So if you take testing/resources/pixel/bug_718762.in and convert it to bug_718762.pdf. The image inside is 5000x5000 with BPC\u003d8 and 4 components, but only takes up 734 bytes. Is this returning the 734 bytes of raw data, or a 5000x5000*4 bitmap? If it\u0027s returning the bitmap, doesn\u0027t it have to render the 734 bytes of data into a bitmap?",
      "parentUuid": "8946f27c_d483574d",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0832ba53_4a6c612f",
        "filename": "public/fpdf_edit.h",
        "patchSetId": 3
      },
      "lineNbr": 291,
      "author": {
        "id": 6975
      },
      "writtenOn": "2017-08-03T01:13:20Z",
      "side": 1,
      "message": "Yea you are right, the encoded data takes up 734 bytes, whereas the bitmap takes up 5000x5000*4. My understanding is that the \"extra\" data simply comes from decoding. CPDF_Image::LoadDIBSource() decodes the raw data and stores the decoded data in a CFX_DIBSource; then CFX_DIBSource::Clone() converts CFX_DIBSource into a CFX_DIBitmap by scanning each row with a decoder. Is this called rendering?\nApologies for my lack of knowledge on images. :)",
      "parentUuid": "3bf2163e_9306096f",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3f698e4d_564da8fa",
        "filename": "public/fpdf_edit.h",
        "patchSetId": 3
      },
      "lineNbr": 291,
      "author": {
        "id": 5045
      },
      "writtenOn": "2017-08-03T01:27:58Z",
      "side": 1,
      "message": "Maybe https://en.wikipedia.org/wiki/Rasterisation is even more accurate?",
      "parentUuid": "0832ba53_4a6c612f",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "53b094c1_8ed7d4bd",
        "filename": "public/fpdf_edit.h",
        "patchSetId": 3
      },
      "lineNbr": 291,
      "author": {
        "id": 6975
      },
      "writtenOn": "2017-08-03T02:12:53Z",
      "side": 1,
      "message": "This sounds more like the right thing!",
      "parentUuid": "3f698e4d_564da8fa",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "981cce48_20ddc9db",
        "filename": "public/fpdf_edit.h",
        "patchSetId": 3
      },
      "lineNbr": 295,
      "author": {
        "id": 5045
      },
      "writtenOn": "2017-08-02T01:26:25Z",
      "side": 1,
      "message": "Who owns the bitmap?",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5b236318_41f98967",
        "filename": "public/fpdf_edit.h",
        "patchSetId": 3
      },
      "lineNbr": 295,
      "author": {
        "id": 6975
      },
      "writtenOn": "2017-08-02T01:41:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "981cce48_20ddc9db",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a0bd0484_05836db4",
        "filename": "testing/embedder_test.cpp",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 5045
      },
      "writtenOn": "2017-08-02T01:26:25Z",
      "side": 1,
      "message": "What about FPDFBitmap_Unknown?",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1704896e_cdf1b626",
        "filename": "testing/embedder_test.cpp",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 6975
      },
      "writtenOn": "2017-08-02T01:41:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a0bd0484_05836db4",
      "revId": "d45ce941e789604bca345d3c8cf0d660dc8a632a",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": false
    }
  ]
}